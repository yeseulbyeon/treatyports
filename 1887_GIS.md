GIS 1887
================
Ye Seul Byeon
5/16/2018

``` r
#reading in excel file
#list.files('data')
tabular <- read_xlsx('data/JapanG_RawData_beta.xlsx')
tabular
```

    ## # A tibble: 718 x 205
    ##    KGun_ID Kuni_ID M17G_ID Ken_Nm Kuni_Nm Gun_Nm     MeijiYear Notes      
    ##      <dbl>   <dbl>   <dbl> <chr>  <chr>   <chr>      <chr>     <chr>      
    ##  1     101       1       1 Aomori Mutsu   Higashits… M20       <NA>       
    ##  2     102       1       2 Aomori Mutsu   Nishitsug… M20       <NA>       
    ##  3     103       1       3 Aomori Mutsu   Nakatsuga… M20       <NA>       
    ##  4     104       1       4 Aomori Mutsu   Minamitsu… M20       <NA>       
    ##  5     105       1       5 Aomori Mutsu   Kitatsuga… M20       <NA>       
    ##  6     106       1       6 Aomori Mutsu   Kamikita   M20       <NA>       
    ##  7     107       1       7 Aomori Mutsu   Shitakita  M20       <NA>       
    ##  8     108       1       8 Aomori Mutsu   Sannohe    M20       <NA>       
    ##  9     109       1       9 Aomori Mutsu   Ninohe     M22       <NA>       
    ## 10     201       2       1 Iwate  Rikuchû Nishiiwai  M22       Cells with…
    ## # ... with 708 more rows, and 197 more variables: RSI_19Sep07 <dbl>,
    ## #   RSIX19Sep07 <dbl>, RSI_11Sep07 <dbl>, RSIX11Sept07 <dbl>,
    ## #   RSI_9Jun07 <dbl>, RSIX9Jun07 <chr>, CPZ <chr>, Hi_LUH <chr>,
    ## #   Sum_Pop <chr>, URC <dbl>, Pct_class <dbl>, Size_class <dbl>,
    ## #   Pct_Urb <dbl>, AreaGIS <dbl>, Calc_Pop <chr>, JPT_ID <chr>,
    ## #   G277 <chr>, G278 <chr>, G001_cho <dbl>, G001_km2 <dbl>,
    ## #   G002_cho <dbl>, G282_km2 <dbl>, G1_G2 <dbl>, Missing <dbl>,
    ## #   G4_G5 <dbl>, G004_cho <dbl>, G005_cho <dbl>, G006_cho <dbl>,
    ## #   G007_yen <dbl>, G009_cho <dbl>, G010_yen <dbl>, G137 <dbl>,
    ## #   G402_cho <dbl>, G405_cho <chr>, G016_cho <dbl>, G016_km2 <dbl>,
    ## #   G408_cho <dbl>, G398 <dbl>, G399 <dbl>, G021 <dbl>, g021P <dbl>,
    ## #   g015R <dbl>, g21_g305 <dbl>, G347 <dbl>, G026 <dbl>, G032 <dbl>,
    ## #   G033 <dbl>, G034 <dbl>, G035 <dbl>, G036 <dbl>, G037 <dbl>,
    ## #   G038 <dbl>, G039 <dbl>, G301 <dbl>, G302 <dbl>, G303 <dbl>,
    ## #   G304 <dbl>, G305 <dbl>, G306 <dbl>, G316 <dbl>, G318 <dbl>,
    ## #   G319 <dbl>, G320 <dbl>, G321 <dbl>, G322 <dbl>, G323 <dbl>,
    ## #   G336 <dbl>, G337 <dbl>, G040 <dbl>, G041 <dbl>, G338 <dbl>,
    ## #   G339 <dbl>, G340 <dbl>, G341 <dbl>, G029 <dbl>, G030 <dbl>,
    ## #   G031 <dbl>, G348 <dbl>, G283 <dbl>, G284 <dbl>, G285 <dbl>,
    ## #   g303_g285 <chr>, G286 <dbl>, G525 <dbl>, G523 <dbl>, G042 <dbl>,
    ## #   G043 <chr>, G044 <chr>, G045 <dbl>, G046 <chr>, G047 <chr>,
    ## #   G324 <dbl>, G325 <chr>, G326 <chr>, G360 <dbl>, G361 <dbl>,
    ## #   G362 <dbl>, G054 <chr>, G055 <chr>, G056 <chr>, …

``` r
#tidying the tabular dataset
tabular_tidy <- tabular %>%
  #converting meiji year to calendar year
  mutate(MeijiYear = as.numeric(gsub("M", "", MeijiYear))) %>%
  mutate(Year = MeijiYear + 1867) %>%
  select(KGun_ID, Kuni_ID, Ken_Nm, Kuni_Nm, Gun_Nm, Year, G063, G064, G121, G203, G206)

#rename columns
names(tabular_tidy)[7:11] = c("All_Bovine", "All_Horses", "Malnutrition_Deaths", "Bovine_Bred", "Horses_Bred")

str(tabular_tidy)
```

    ## Classes 'tbl_df', 'tbl' and 'data.frame':    718 obs. of  11 variables:
    ##  $ KGun_ID            : num  101 102 103 104 105 106 107 108 109 201 ...
    ##  $ Kuni_ID            : num  1 1 1 1 1 1 1 1 1 2 ...
    ##  $ Ken_Nm             : chr  "Aomori" "Aomori" "Aomori" "Aomori" ...
    ##  $ Kuni_Nm            : chr  "Mutsu" "Mutsu" "Mutsu" "Mutsu" ...
    ##  $ Gun_Nm             : chr  "Higashitsugaru" "Nishitsugaru" "Nakatsugaru Incl Hirosaki)" "Minamitsugaru" ...
    ##  $ Year               : num  1887 1887 1887 1887 1887 ...
    ##  $ All_Bovine         : num  82 99 135 0 145 ...
    ##  $ All_Horses         : num  6940 6810 5698 6716 5081 ...
    ##  $ Malnutrition_Deaths: num  169 83 194 172 76 125 66 239 102 157 ...
    ##  $ Bovine_Bred        : chr  "12" "2" "12" NA ...
    ##  $ Horses_Bred        : num  406 257 44 75 24 ...

``` r
sum(tabular_tidy$All_Bovine, na.rm = TRUE)
```

    ## [1] 1020394

``` r
tabular_tidy %>%
  group_by(Kuni_Nm) %>%
  summarize(All_Bovine = sum(All_Bovine))
```

    ## # A tibble: 72 x 2
    ##    Kuni_Nm  All_Bovine
    ##    <chr>         <dbl>
    ##  1 Aki           37585
    ##  2 Awa           27752
    ##  3 Awaji         10086
    ##  4 Bingo         41817
    ##  5 Bitchû        36916
    ##  6 Bizen         21309
    ##  7 Bungo         64850
    ##  8 Buzen         16473
    ##  9 Chikugo         234
    ## 10 Chikuzen      27529
    ## # ... with 62 more rows

``` r
#animal_consumption <- read_csv('data/animal_product_cleaned.csv') %>%
 # select(-c(8:11))

#cols_to_change = c(2, 3, 5:8)
#for(i in cols_to_change){
#   class(animal_consumption[, i]) = "double"
#}
#str(animal_consumption)
```

``` r
japan1887_kuni <- readOGR("./data/JapanKuni_1887.shp")
```

    ## OGR data source with driver: ESRI Shapefile 
    ## Source: "/Users/yeseulbyeon/Desktop/treatyports/data/JapanKuni_1887.shp", layer: "JapanKuni_1887"
    ## with 70 features
    ## It has 5 fields

``` r
hokkaido1887_kuni <- readOGR("./data/JapanKuni_Hokkaido__1887.shp")
```

    ## OGR data source with driver: ESRI Shapefile 
    ## Source: "/Users/yeseulbyeon/Desktop/treatyports/data/JapanKuni_Hokkaido__1887.shp", layer: "JapanKuni_Hokkaido__1887"
    ## with 10 features
    ## It has 5 fields

``` r
japan1887_gun <- readOGR("./data/JapanGun_1887.shp")
```

    ## OGR data source with driver: ESRI Shapefile 
    ## Source: "/Users/yeseulbyeon/Desktop/treatyports/data/JapanGun_1887.shp", layer: "JapanGun_1887"
    ## with 677 features
    ## It has 21 fields

``` r
japan1887_ken <- readOGR("./data/JapanKen_1887.shp")
```

    ## OGR data source with driver: ESRI Shapefile 
    ## Source: "/Users/yeseulbyeon/Desktop/treatyports/data/JapanKen_1887.shp", layer: "JapanKen_1887"
    ## with 39 features
    ## It has 3 fields

``` r
joined <- readOGR("./data/new_shp.shp")
```

    ## OGR data source with driver: ESRI Shapefile 
    ## Source: "/Users/yeseulbyeon/Desktop/treatyports/data/new_shp.shp", layer: "new_shp"
    ## with 70 features
    ## It has 209 fields

``` r
#hokkaido kuni
(hokkaido1887_process <- hokkaido1887_kuni %>%
  fortify(region = "KUNI_RM") %>%
  as_tibble() %>%
  left_join(hokkaido1887_kuni@data, by = c("id" = "KUNI_RM")))
```

    ## Warning: Column `id`/`KUNI_RM` joining character vector and factor,
    ## coercing into character vector

    ## # A tibble: 67,574 x 11
    ##     long   lat order hole  piece id     group  OBJECTID KUNI_JP     KEN_RM
    ##    <dbl> <dbl> <int> <lgl> <fct> <chr>  <fct>     <int> <fct>       <fct> 
    ##  1  142.  42.9     1 FALSE 1     Hidaka Hidak…       78 "\u0093ú\u… Hidaka
    ##  2  142.  42.9     2 FALSE 1     Hidaka Hidak…       78 "\u0093ú\u… Hidaka
    ##  3  142.  42.9     3 FALSE 1     Hidaka Hidak…       78 "\u0093ú\u… Hidaka
    ##  4  142.  42.9     4 FALSE 1     Hidaka Hidak…       78 "\u0093ú\u… Hidaka
    ##  5  142.  42.9     5 FALSE 1     Hidaka Hidak…       78 "\u0093ú\u… Hidaka
    ##  6  142.  42.9     6 FALSE 1     Hidaka Hidak…       78 "\u0093ú\u… Hidaka
    ##  7  142.  42.9     7 FALSE 1     Hidaka Hidak…       78 "\u0093ú\u… Hidaka
    ##  8  142.  42.9     8 FALSE 1     Hidaka Hidak…       78 "\u0093ú\u… Hidaka
    ##  9  142.  42.9     9 FALSE 1     Hidaka Hidak…       78 "\u0093ú\u… Hidaka
    ## 10  142.  42.9    10 FALSE 1     Hidaka Hidak…       78 "\u0093ú\u… Hidaka
    ## # ... with 67,564 more rows, and 1 more variable: KEN_JP <fct>

``` r
names(hokkaido1887_process)[8]<-"Kuni_ID"

hokkaido1887_process
```

    ## # A tibble: 67,574 x 11
    ##     long   lat order hole  piece id    group Kuni_ID KUNI_JP KEN_RM KEN_JP
    ##    <dbl> <dbl> <int> <lgl> <fct> <chr> <fct>   <int> <fct>   <fct>  <fct> 
    ##  1  142.  42.9     1 FALSE 1     Hida… Hida…      78 "\u009… Hidaka "\u00…
    ##  2  142.  42.9     2 FALSE 1     Hida… Hida…      78 "\u009… Hidaka "\u00…
    ##  3  142.  42.9     3 FALSE 1     Hida… Hida…      78 "\u009… Hidaka "\u00…
    ##  4  142.  42.9     4 FALSE 1     Hida… Hida…      78 "\u009… Hidaka "\u00…
    ##  5  142.  42.9     5 FALSE 1     Hida… Hida…      78 "\u009… Hidaka "\u00…
    ##  6  142.  42.9     6 FALSE 1     Hida… Hida…      78 "\u009… Hidaka "\u00…
    ##  7  142.  42.9     7 FALSE 1     Hida… Hida…      78 "\u009… Hidaka "\u00…
    ##  8  142.  42.9     8 FALSE 1     Hida… Hida…      78 "\u009… Hidaka "\u00…
    ##  9  142.  42.9     9 FALSE 1     Hida… Hida…      78 "\u009… Hidaka "\u00…
    ## 10  142.  42.9    10 FALSE 1     Hida… Hida…      78 "\u009… Hidaka "\u00…
    ## # ... with 67,564 more rows

``` r
#japan kuni
japan1887_kuni_process <- japan1887_kuni %>%
  fortify(region = "KUNI_RM") %>%
  as_tibble() %>%
  left_join(japan1887_kuni@data, by = c("id" = "KUNI_RM")) %>%
  mutate(Kuni_ID = OBJECTID)
```

    ## Warning: Column `id`/`KUNI_RM` joining character vector and factor,
    ## coercing into character vector

``` r
names(japan1887_kuni_process)[6]<-"Kuni_Nm"
japan1887_kuni_process <- japan1887_kuni_process %>%
  mutate(id = Kuni_ID)

japan1887_kuni_process
```

    ## # A tibble: 234,548 x 13
    ##     long   lat order hole  piece Kuni_Nm group OBJECTID KUNI_JP    KEN_RM 
    ##    <dbl> <dbl> <int> <lgl> <fct> <chr>   <fct>    <int> <fct>      <fct>  
    ##  1  133.  34.8     1 FALSE 1     Aki     Aki.1        1 "\u0088À\… Hirosh…
    ##  2  133.  34.8     2 FALSE 1     Aki     Aki.1        1 "\u0088À\… Hirosh…
    ##  3  133.  34.8     3 FALSE 1     Aki     Aki.1        1 "\u0088À\… Hirosh…
    ##  4  133.  34.8     4 FALSE 1     Aki     Aki.1        1 "\u0088À\… Hirosh…
    ##  5  133.  34.8     5 FALSE 1     Aki     Aki.1        1 "\u0088À\… Hirosh…
    ##  6  133.  34.8     6 FALSE 1     Aki     Aki.1        1 "\u0088À\… Hirosh…
    ##  7  133.  34.8     7 FALSE 1     Aki     Aki.1        1 "\u0088À\… Hirosh…
    ##  8  133.  34.8     8 FALSE 1     Aki     Aki.1        1 "\u0088À\… Hirosh…
    ##  9  133.  34.8     9 FALSE 1     Aki     Aki.1        1 "\u0088À\… Hirosh…
    ## 10  133.  34.8    10 FALSE 1     Aki     Aki.1        1 "\u0088À\… Hirosh…
    ## # ... with 234,538 more rows, and 3 more variables: KEN_JP <fct>,
    ## #   Kuni_ID <int>, id <int>

``` r
library(dplyr)
#japan gun
(japan1887_gun_process <- japan1887_gun %>%
  fortify(region = "GUN_RM") %>%
  as_tibble() %>%
  left_join(japan1887_gun@data, by = c("id" = "GUN_RM")))
```

    ## Warning: Column `id`/`GUN_RM` joining character vector and factor, coercing
    ## into character vector

    ## # A tibble: 300,630 x 27
    ##     long   lat order hole  piece id    group GUN_CODE GUN_JP       KUNI_RM
    ##    <dbl> <dbl> <int> <lgl> <fct> <chr> <fct>    <dbl> <fct>        <fct>  
    ##  1  138.  35.2     1 FALSE 1     Abe   Abe.1     3301 "\u0088À\u0… Suruga 
    ##  2  138.  35.2     2 FALSE 1     Abe   Abe.1     3301 "\u0088À\u0… Suruga 
    ##  3  138.  35.1     3 FALSE 1     Abe   Abe.1     3301 "\u0088À\u0… Suruga 
    ##  4  138.  35.1     4 FALSE 1     Abe   Abe.1     3301 "\u0088À\u0… Suruga 
    ##  5  138.  35.1     5 FALSE 1     Abe   Abe.1     3301 "\u0088À\u0… Suruga 
    ##  6  138.  35.1     6 FALSE 1     Abe   Abe.1     3301 "\u0088À\u0… Suruga 
    ##  7  138.  35.1     7 FALSE 1     Abe   Abe.1     3301 "\u0088À\u0… Suruga 
    ##  8  138.  35.1     8 FALSE 1     Abe   Abe.1     3301 "\u0088À\u0… Suruga 
    ##  9  138.  35.1     9 FALSE 1     Abe   Abe.1     3301 "\u0088À\u0… Suruga 
    ## 10  138.  35.1    10 FALSE 1     Abe   Abe.1     3301 "\u0088À\u0… Suruga 
    ## # ... with 300,620 more rows, and 17 more variables: KUNI_JP <fct>,
    ## #   KEN_RM <fct>, KEN_JP <fct>, KUNI <int>, GUN <int>, M17_GUN <fct>,
    ## #   NEN__YEAR <fct>, NOTES <fct>, KuniCode <dbl>, M17_gunID <dbl>,
    ## #   Year <fct>, G278_koku <dbl>, G021_hou <dbl>, g021_per <dbl>,
    ## #   g15R_pop <dbl>, G026_sch <dbl>, CODE <int>

``` r
#japan ken
(japan1887_ken_process <- japan1887_ken %>%
  fortify(region = "KEN_RM") %>%
  as_tibble() %>%
  left_join(japan1887_ken@data, by = c("id" = "KEN_RM")))
```

    ## Warning: Column `id`/`KEN_RM` joining character vector and factor, coercing
    ## into character vector

    ## # A tibble: 169,386 x 9
    ##     long   lat order hole  piece id    group   OBJECTID KEN_JP          
    ##    <dbl> <dbl> <int> <lgl> <fct> <chr> <fct>      <int> <fct>           
    ##  1  137.  35.4     1 FALSE 1     Aichi Aichi.1        1 "\u0088¤\u0092m"
    ##  2  137.  35.4     2 FALSE 1     Aichi Aichi.1        1 "\u0088¤\u0092m"
    ##  3  137.  35.4     3 FALSE 1     Aichi Aichi.1        1 "\u0088¤\u0092m"
    ##  4  137.  35.4     4 FALSE 1     Aichi Aichi.1        1 "\u0088¤\u0092m"
    ##  5  137.  35.4     5 FALSE 1     Aichi Aichi.1        1 "\u0088¤\u0092m"
    ##  6  137.  35.4     6 FALSE 1     Aichi Aichi.1        1 "\u0088¤\u0092m"
    ##  7  137.  35.4     7 FALSE 1     Aichi Aichi.1        1 "\u0088¤\u0092m"
    ##  8  137.  35.4     8 FALSE 1     Aichi Aichi.1        1 "\u0088¤\u0092m"
    ##  9  137.  35.4     9 FALSE 1     Aichi Aichi.1        1 "\u0088¤\u0092m"
    ## 10  137.  35.4    10 FALSE 1     Aichi Aichi.1        1 "\u0088¤\u0092m"
    ## # ... with 169,376 more rows

``` r
(new_shp <- joined %>%
  fortify(region = "KUNI_RM") %>%
  as_tibble() %>%
  left_join(joined@data, by = c("id" = "KUNI_RM")))
```

    ## Warning: Column `id`/`KUNI_RM` joining character vector and factor,
    ## coercing into character vector

    ## # A tibble: 234,548 x 215
    ##     long   lat order hole  piece id    group OBJECTID KUNI_JP KEN_RM   
    ##    <dbl> <dbl> <int> <lgl> <fct> <chr> <fct>    <int> <fct>   <fct>    
    ##  1  133.  34.8     1 FALSE 1     Aki   Aki.1        1 ���|    Hiroshima
    ##  2  133.  34.8     2 FALSE 1     Aki   Aki.1        1 ���|    Hiroshima
    ##  3  133.  34.8     3 FALSE 1     Aki   Aki.1        1 ���|    Hiroshima
    ##  4  133.  34.8     4 FALSE 1     Aki   Aki.1        1 ���|    Hiroshima
    ##  5  133.  34.8     5 FALSE 1     Aki   Aki.1        1 ���|    Hiroshima
    ##  6  133.  34.8     6 FALSE 1     Aki   Aki.1        1 ���|    Hiroshima
    ##  7  133.  34.8     7 FALSE 1     Aki   Aki.1        1 ���|    Hiroshima
    ##  8  133.  34.8     8 FALSE 1     Aki   Aki.1        1 ���|    Hiroshima
    ##  9  133.  34.8     9 FALSE 1     Aki   Aki.1        1 ���|    Hiroshima
    ## 10  133.  34.8    10 FALSE 1     Aki   Aki.1        1 ���|    Hiroshima
    ## # ... with 234,538 more rows, and 205 more variables: KEN_JP <fct>,
    ## #   JapanG_Raw <fct>, JapanG_R_1 <fct>, JapanG_R_2 <fct>,
    ## #   JapanG_R_3 <fct>, JapanG_R_4 <fct>, JapanG_R_5 <fct>,
    ## #   JapanG_R_6 <fct>, JapanG_R_7 <fct>, JapanG_R_8 <fct>,
    ## #   JapanG_R_9 <fct>, JapanG_R10 <fct>, JapanG_R11 <fct>,
    ## #   JapanG_R12 <fct>, JapanG_R13 <fct>, JapanG_R14 <fct>,
    ## #   JapanG_R15 <fct>, JapanG_R16 <fct>, JapanG_R17 <fct>,
    ## #   JapanG_R18 <fct>, JapanG_R19 <fct>, JapanG_R20 <fct>,
    ## #   JapanG_R21 <fct>, JapanG_R22 <fct>, JapanG_R23 <fct>,
    ## #   JapanG_R24 <fct>, JapanG_R25 <fct>, JapanG_R26 <fct>,
    ## #   JapanG_R27 <fct>, JapanG_R28 <fct>, JapanG_R29 <fct>,
    ## #   JapanG_R30 <fct>, JapanG_R31 <fct>, JapanG_R32 <fct>,
    ## #   JapanG_R33 <fct>, JapanG_R34 <fct>, JapanG_R35 <fct>,
    ## #   JapanG_R36 <fct>, JapanG_R37 <fct>, JapanG_R38 <fct>,
    ## #   JapanG_R39 <fct>, JapanG_R40 <fct>, JapanG_R41 <fct>,
    ## #   JapanG_R42 <fct>, JapanG_R43 <fct>, JapanG_R44 <fct>,
    ## #   JapanG_R45 <fct>, JapanG_R46 <fct>, JapanG_R47 <fct>,
    ## #   JapanG_R48 <fct>, JapanG_R49 <fct>, JapanG_R50 <fct>,
    ## #   JapanG_R51 <fct>, JapanG_R52 <fct>, JapanG_R53 <fct>,
    ## #   JapanG_R54 <fct>, JapanG_R55 <fct>, JapanG_R56 <fct>,
    ## #   JapanG_R57 <fct>, JapanG_R58 <fct>, JapanG_R59 <fct>,
    ## #   JapanG_R60 <fct>, JapanG_R61 <fct>, JapanG_R62 <fct>,
    ## #   JapanG_R63 <fct>, JapanG_R64 <fct>, JapanG_R65 <fct>,
    ## #   JapanG_R66 <fct>, JapanG_R67 <fct>, JapanG_R68 <fct>,
    ## #   JapanG_R69 <fct>, JapanG_R70 <fct>, JapanG_R71 <fct>,
    ## #   JapanG_R72 <fct>, JapanG_R73 <fct>, JapanG_R74 <fct>,
    ## #   JapanG_R75 <fct>, JapanG_R76 <fct>, JapanG_R77 <fct>,
    ## #   JapanG_R78 <fct>, JapanG_R79 <fct>, JapanG_R80 <fct>,
    ## #   JapanG_R81 <fct>, JapanG_R82 <fct>, JapanG_R83 <fct>,
    ## #   JapanG_R84 <fct>, JapanG_R85 <fct>, JapanG_R86 <fct>,
    ## #   JapanG_R87 <fct>, JapanG_R88 <fct>, JapanG_R89 <fct>,
    ## #   JapanG_R90 <fct>, JapanG_R91 <fct>, JapanG_R92 <fct>,
    ## #   JapanG_R93 <fct>, JapanG_R94 <fct>, JapanG_R95 <fct>,
    ## #   JapanG_R96 <fct>, JapanG_R97 <fct>, JapanG_R98 <fct>, …

``` r
new_shp <- new_shp %>%
  select(long, lat, id, OBJECTID, JapanG_R99.9, JapanG_R99.10, JapanG_R99.34, JapanG_R99.73, JapanG_R99.74)

str(new_shp)
```

    ## Classes 'tbl_df', 'tbl' and 'data.frame':    234548 obs. of  9 variables:
    ##  $ long         : num  133 133 133 133 133 ...
    ##  $ lat          : num  34.8 34.8 34.8 34.8 34.8 ...
    ##  $ id           : chr  "Aki" "Aki" "Aki" "Aki" ...
    ##  $ OBJECTID     : int  1 1 1 1 1 1 1 1 1 1 ...
    ##  $ JapanG_R99.9 : Factor w/ 56 levels "0","1","1010",..: 43 43 43 43 43 43 43 43 43 43 ...
    ##  $ JapanG_R99.10: Factor w/ 52 levels "0","1","10","100",..: 46 46 46 46 46 46 46 46 46 46 ...
    ##  $ JapanG_R99.34: Factor w/ 51 levels "10","102","110",..: 2 2 2 2 2 2 2 2 2 2 ...
    ##  $ JapanG_R99.73: Factor w/ 35 levels "*","0","1","14",..: 5 5 5 5 5 5 5 5 5 5 ...
    ##  $ JapanG_R99.74: Factor w/ 24 levels "0","1","10","1065",..: 4 4 4 4 4 4 4 4 4 4 ...

``` r
(hokkaido <- ggplot(data = hokkaido1887_process, mapping = aes(x = long, y = lat, group = group)) + 
  coord_fixed(1.3) + 
  geom_polygon(color = "#252525", fill = "#a6bddb", size = 0.2))


#(japan_kuni <- ggplot(data = japan1887_kuni_process, mapping = aes(x = long, y = lat, group = group)) + 
  coord_fixed(1.3) + 
  geom_polygon(color = "#252525", fill = "#a6bddb", size = 0.2))

ggplot(data = japan1887_ken_process, mapping = aes(x = long, y = lat, group = group)) + 
  coord_fixed(1.3) + 
  geom_polygon(color = "#252525", fill = "#a6bddb", size = 0.2) +
  geom_text(label = Ken_Nm)

japan1887_ken_process

(japan_gun <- ggplot(data = japan1887_gun_process, mapping = aes(x = long, y = lat, group = group)) + 
  coord_fixed(1.3) + 
  geom_polygon(color = '#252525', fill = "#a6bddb", size = 0.2))

(joined <- ggplot(data = joined, mapping = aes(x = long, y = lat, group = group)) + 
  coord_fixed(1.3) + 
  geom_polygon(color = "#252525", fill = "#a6bddb", size = 0.2))
```

``` r
sum_tabular_cows <- tabular_tidy %>%
  group_by(Kuni_Nm, Kuni_ID) %>%
  summarize(All_Bovine = sum(All_Bovine, na.rm = TRUE))

sum_tabular_horses <- tabular_tidy %>%
  group_by(Kuni_Nm, Kuni_ID) %>%
  summarize(All_Horses = sum(All_Horses, na.rm = TRUE))


cattle_kuni <- ggplot() + 
    ggtitle("No. of Cows, by Kuni") +
    geom_map(aes(x = long, y = lat, map_id = Kuni_ID), data = japan1887_kuni_process, map = japan1887_kuni_process, fill = "#FFFFFF", color = "#000000", size = 0.15) +
    geom_map(data = sum_tabular_cows, map = japan1887_kuni_process, aes(fill = All_Bovine, map_id = Kuni_ID), size=0.15) + 
  coord_fixed(x = japan1887_kuni_process$long, y = japan1887_kuni_process$lat) + 
  scale_fill_viridis()
```

    ## Warning: Unknown or uninitialised column: 'region'.

    ## Warning: Ignoring unknown aesthetics: x, y

    ## Warning: Unknown or uninitialised column: 'region'.

``` r
horse_kuni <- ggplot() + 
    ggtitle("No. of Horses, by Kuni") +
    geom_map(data = japan1887_kuni_process, map = japan1887_kuni_process, 
             aes(x = long, y = lat, map_id = Kuni_ID),  fill = "#FFFFFF", color = "#000000", size = 0.15) +
    geom_map(data = sum_tabular_horses, map = japan1887_kuni_process, 
             aes(fill = All_Horses, map_id = Kuni_ID), size=0.15) + 
  coord_fixed(x = japan1887_kuni_process$long, y = japan1887_kuni_process$lat) + 
  scale_fill_viridis()
```

    ## Warning: Unknown or uninitialised column: 'region'.

    ## Warning: Ignoring unknown aesthetics: x, y

    ## Warning: Unknown or uninitialised column: 'region'.
